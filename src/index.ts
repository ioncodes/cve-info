import { MITRE } from "./interfaces/mitre"
import CVE from "./interfaces/cve"
import { createRequest } from "./utils"

function fetchMitre(cveId: string): Promise<CVE> {
  return new Promise<CVE>((resolve, reject) => {
    createRequest<MITRE>(`https://cve.circl.lu/api/cve/${cveId}`)
      .then((cve: MITRE) => resolve({ id: cve.id, summary: cve.summary }))
      .catch(reject)
  })
}

export {
  fetchMitre
}